(function(z){"object"===typeof exports&&"undefined"!==typeof module?module.exports=z():"function"===typeof define&&define.U?define([],z):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).martinez=z()})(function(){return function g(c,e,f){function a(b,r){if(!e[b]){if(!c[b]){var u="function"==typeof require&&require;if(!r&&u)return u(b,!0);if(d)return d(b,!0);u=Error("Cannot find module '"+b+"'");throw u.code="MODULE_NOT_FOUND",u;}u=e[b]={exports:{}};
c[b][0].call(u.exports,function(d){var r=c[b][1][d];return a(r?r:d)},u,u.exports,g,c,e,f)}return e[b].exports}for(var d="function"==typeof require&&require,b=0;b<f.length;b++)a(f[b]);return a}({1:[function(g,c){c.exports=g("./src/index")},{"./src/index":11}],2:[function(g,c){c.exports={P:g("./lib/rbtree"),T:g("./lib/bintree")}},{"./lib/bintree":3,"./lib/rbtree":4}],3:[function(g,c){function e(a){this.data=a;this.right=this.left=null}function f(a){this.c=null;this.l=a;this.size=0}var a=g("./treebase");
e.prototype.g=function(a){return a?this.right:this.left};e.prototype.j=function(a,b){a?this.right=b:this.left=b};f.prototype=new a;f.prototype.M=function(a){if(null===this.c)return this.c=new e(a),this.size++,!0;for(var b=0,h=null,r=this.c;;){if(null===r)return r=new e(a),h.j(b,r),ret=!0,this.size++,!0;if(0===this.l(r.data,a))return!1;b=0>this.l(r.data,a);h=r;r=r.g(b)}};f.prototype.remove=function(a){if(null===this.c)return!1;var b=new e(void 0),h=b;h.right=this.c;for(var r=null,f=null,k=1;null!==
h.g(k);){var r=h,h=h.g(k),c=this.l(a,h.data),k=0<c;0===c&&(f=h)}return null!==f?(f.data=h.data,r.j(r.right===h,h.g(null===h.left)),this.c=b.right,this.size--,!0):!1};c.exports=f},{"./treebase":5}],4:[function(g,c){function e(a){this.data=a;this.right=this.left=null;this.red=!0}function f(a){this.c=null;this.l=a;this.size=0}function a(a){return null!==a&&a.red}function d(a,d){var b=a.g(!d);a.j(!d,b.g(d));b.j(d,a);a.red=!0;b.red=!1;return b}function b(a,b){a.j(!b,d(a.g(!b),!b));return d(a,b)}var h=
g("./treebase");e.prototype.g=function(a){return a?this.right:this.left};e.prototype.j=function(a,b){a?this.right=b:this.left=b};f.prototype=new h;f.prototype.M=function(h){var f=!1;if(null===this.c)this.c=new e(h),f=!0,this.size++;else{var k=new e(void 0),c=0,g=0,t=null,l=k,q=null,m=this.c;for(l.right=this.c;;){null===m?(m=new e(h),q.j(c,m),f=!0,this.size++):a(m.left)&&a(m.right)&&(m.red=!0,m.left.red=!1,m.right.red=!1);if(a(m)&&a(q)){var v=l.right===t;m===q.g(g)?l.j(v,d(t,!g)):l.j(v,b(t,!g))}v=
this.l(m.data,h);if(0===v)break;g=c;c=0>v;null!==t&&(l=t);t=q;q=m;m=m.g(c)}this.c=k.right}this.c.red=!1;return f};f.prototype.remove=function(h){if(null===this.c)return!1;var f=new e(void 0),k=f;k.right=this.c;for(var c=null,g,t=null,l=1;null!==k.g(l);){var q=l;g=c;var c=k,k=k.g(l),m=this.l(h,k.data),l=0<m;0===m&&(t=k);if(!a(k)&&!a(k.g(l)))if(a(k.g(!l)))g=d(k,l),c.j(q,g),c=g;else if(!a(k.g(!l))&&(m=c.g(!q),null!==m))if(a(m.g(!q))||a(m.g(q))){var v=g.right===c;a(m.g(q))?g.j(v,b(c,q)):a(m.g(!q))&&g.j(v,
d(c,q));q=g.g(v);q.red=!0;k.red=!0;q.left.red=!1;q.right.red=!1}else c.red=!1,m.red=!0,k.red=!0}null!==t&&(t.data=k.data,c.j(c.right===k,k.g(null===k.left)),this.size--);this.c=f.right;null!==this.c&&(this.c.red=!1);return null!==t};c.exports=f},{"./treebase":5}],5:[function(g,c){function e(){}function f(a){this.L=a;this.i=[];this.f=null}e.prototype.clear=function(){this.c=null;this.size=0};e.prototype.find=function(a){for(var d=this.c;null!==d;){var b=this.l(a,d.data);if(0===b)return d.data;d=d.g(0<
b)}return null};e.prototype.o=function(a){for(var d=this.c,b=this.iterator();null!==d;){var h=this.l(a,d.data);if(0===h)return b.f=d,b;b.i.push(d);d=d.g(0<h)}return null};e.prototype.lowerBound=function(a){for(var d=this.c,b=this.iterator(),h=this.l;null!==d;){var f=h(a,d.data);if(0===f)return b.f=d,b;b.i.push(d);d=d.g(0<f)}for(f=b.i.length-1;0<=f;--f)if(d=b.i[f],0>h(a,d.data))return b.f=d,b.i.length=f,b;b.i.length=0;return b};e.prototype.upperBound=function(a){for(var d=this.lowerBound(a),b=this.l;null!==
d.data()&&0===b(d.data(),a);)d.next();return d};e.prototype.min=function(){var a=this.c;if(null===a)return null;for(;null!==a.left;)a=a.left;return a.data};e.prototype.max=function(){var a=this.c;if(null===a)return null;for(;null!==a.right;)a=a.right;return a.data};e.prototype.iterator=function(){return new f(this)};f.prototype.data=function(){return null!==this.f?this.f.data:null};f.prototype.next=function(){if(null===this.f){var a=this.L.c;null!==a&&this.K(a)}else if(null===this.f.right){do if(a=
this.f,this.i.length)this.f=this.i.pop();else{this.f=null;break}while(this.f.right===a)}else this.i.push(this.f),this.K(this.f.right);return null!==this.f?this.f.data:null};f.prototype.D=function(){if(null===this.f){var a=this.L.c;null!==a&&this.J(a)}else if(null===this.f.left){do if(a=this.f,this.i.length)this.f=this.i.pop();else{this.f=null;break}while(this.f.left===a)}else this.i.push(this.f),this.J(this.f.left)};f.prototype.K=function(a){for(;null!==a.left;)this.i.push(a),a=a.left;this.f=a};f.prototype.J=
function(a){for(;null!==a.right;)this.i.push(a),a=a.right;this.f=a};c.exports=e},{}],6:[function(g,c){function e(a,d){if(!(this instanceof e))return new e(a,d);this.data=a||[];this.length=this.data.length;this.compare=d||f;if(a)for(var b=Math.floor(this.length/2);0<=b;b--)this.I(b)}function f(a,d){return a<d?-1:a>d?1:0}c.exports=e;e.prototype={push:function(a){this.data.push(a);this.length++;this.R(this.length-1)},pop:function(){var a=this.data[0];this.data[0]=this.data[this.length-1];this.length--;
this.data.pop();this.I(0);return a},R:function(a){for(var d=this.data,b=this.compare;0<a;){var f=Math.floor((a-1)/2);if(0>b(d[a],d[f])){var c=d,e=c[f];c[f]=c[a];c[a]=e;a=f}else break}},I:function(a){for(var d=this.data,b=this.compare,f=this.length;;){var c=2*a+1,e=c+1,k=a;c<f&&0>b(d[c],d[k])&&(k=c);e<f&&0>b(d[e],d[k])&&(k=e);if(k===a)break;c=d;e=c[k];c[k]=c[a];c[a]=e;a=k}}}},{}],7:[function(g,c){var e=g("./signed_area");c.exports=function(f,a){var d=f.a,b=a.a;return d[0]>b[0]?1:d[0]<b[0]?-1:d[1]!==
b[1]?d[1]>b[1]?1:-1:f.left!==a.left?f.left?1:-1:0!==e(d,f.b.a,a.b.a)?f.A(a.b.a)?-1:1:f.h===a.h?f.m>a.m?-1:1:!f.h&&a.h?1:-1}},{"./signed_area":13}],8:[function(g,c){var e=g("./signed_area"),f=g("./compare_events"),a=g("./equals");c.exports=function(d,b){return d===b?0:0!==e(d.a,d.b.a,b.a)||0!==e(d.a,d.b.a,b.b.a)?a(d.a,b.a)?d.A(b.b.a)?-1:1:d.a[0]===b.a[0]?d.a[1]<b.a[1]?-1:1:1===f(d,b)?b.S(d.a)?-1:1:d.A(b.a)?-1:1:d.h!==b.h?d.h&&!b.h?1:-1:a(d.a,b.a)?d.m>b.m?-1:1:1===f(d,b)?1:-1}},{"./compare_events":7,
"./equals":10,"./signed_area":13}],9:[function(g,c){c.exports={G:0,O:1,H:2,F:3}},{}],10:[function(g,c){c.exports=function(c,f){return c[0]===f[0]&&c[1]===f[1]}},{}],11:[function(g,c){function e(a,b,d,c,f){var h,k;if("number"===typeof a[0][0])for(h=0,k=a.length-1;h<k;h++){var g=a[h],n=a[h+1],r=b,p=d+1,u=c,l=f,t=new q(g,!1,void 0,r),n=new q(n,!1,t,r);t.b=n;t.m=n.m=p;0<m(t,n)?n.left=!0:t.left=!0;l[0]=A(l[0],g[0]);l[1]=A(l[1],g[1]);l[2]=C(l[2],g[0]);l[3]=C(l[3],g[1]);u.push(t);u.push(n)}else for(h=0,
k=a.length;h<k;h++)B++,e(a[h],b,B,c,f)}function f(a,b,d,c){var f=new t(null,m);B=0;e(a,!0,0,f,d);e(b,!1,0,f,c);return f}function a(a,b,f,c){null===b?(a.u=!1,a.s=!0):a.h===b.h?(a.u=!b.u,a.s=b.s):(a.u=!b.s,a.s=b.N()?!b.u:b.u);b&&(a.w=!d(b,c)||b.N()?b.w:b);a.C=d(a,c)}function d(a,b){switch(a.type){case w.G:switch(b){case 0:return!a.s;case 1:return a.s;case 2:return a.h&&a.s||!a.h&&!a.s;case 3:return!0}case w.H:return 0===b||1===b;case w.F:return 2===b}return!1}function b(a,b,d){var c=D(a.a,a.b.a,b.a,
b.b.a),f=c?c.length:0;if(0===f||1===f&&(y(a.a,b.a)||y(a.b.a,b.b.a))||2===f&&a.h===b.h)return 0;if(1===f)return y(a.a,c[0])||y(a.b.a,c[0])||h(a,c[0],d),y(b.a,c[0])||y(b.b.a,c[0])||h(b,c[0],d),1;var c=[],e=f=!1;y(a.a,b.a)?f=!0:1===m(a,b)?c.push(b,a):c.push(a,b);y(a.b.a,b.b.a)?e=!0:1===m(a.b,b.b)?c.push(b.b,a.b):c.push(a.b,b.b);if(f&&e||f)return a.type=w.O,b.type=a.u===b.u?w.H:w.F,f&&!e&&h(c[2].b,c[1].a,d),2;if(e)return h(c[0],c[1].a,d),3;if(c[0]!==c[3].b)return h(c[0],c[1].a,d),h(c[1],c[2].a,d),3;h(c[0],
c[1].a,d);h(c[3].b,c[2].a,d);return 3}function h(a,b,d){var c=new q(b,!1,a,a.h);b=new q(b,!0,a.b,a.h);0<m(b,a.b)&&(a.b.left=!0,b.left=!1);a.b.b=b;a.b=c;d.push(b);d.push(c);return d}function r(d,c,f,h,e,k){var g;f=new l(v);c=[];for(var m=A(h[2],e[2]);d.length;){var n=d.pop();c.push(n);if(0===k&&n.a[0]>m||2===k&&n.a[0]>h[2])break;n.left?(f.M(n),g=f.o(n),e=f.o(n),n.iterator=f.o(n),e.data()!==f.min()?e.D():(e=f.o(f.max()),e.next()),g.next(),a(n,e.data(),0,k),g.data()&&2===b(n,g.data(),d)&&(a(n,e.data(),
0,k),a(n,g.data(),0,k)),e.data()&&2===b(e.data(),n,d)&&(g=f.o(e.data()),g.data()!==f.min()?g.D():(g=f.o(f.max()),g.next()),a(e.data(),g.data(),0,k),a(n,e.data(),0,k))):(n=n.b,g=f.o(n),(e=f.o(n))&&g&&(e.data()!==f.min()?e.D():(e=f.o(f.max()),e.next()),g.next(),f.remove(n),g.data()&&e.data()&&b(e.data(),g.data(),d)))}return c}function u(a,b){"[object Array]"===Object.prototype.toString.call(a[0][0])||(a=[a]);a[b]=[]}function k(a,b,d){var c,e=null;if(0===a.length*b.length)if(0===d)e=x;else if(2===d)e=
a;else if(1===d||3===d)e=0===a.length?b:a;if(c=e)return c===x?null:c;var e=[Infinity,Infinity,-Infinity,-Infinity],h=[Infinity,Infinity,-Infinity,-Infinity],g=f(a,b,e,h);c=null;if(e[0]>h[2]||h[0]>e[2]||e[1]>h[3]||h[1]>e[3])if(0===d)c=x;else if(2===d)c=a;else if(1===d||3===d)c=a.concat(b);if(c)return c===x?null:c;e=r(g,0,0,e,h,d);a=[];b=0;for(d=e.length;b<d;b++)h=e[b],(h.left&&h.C||!h.left&&h.b.C)&&a.push(h);for(e=!1;!e;)for(e=!0,b=0,d=a.length;b<d;b++)b+1<d&&1===m(a[b],a[b+1])&&(e=a,h=b+1,g=e[b],
e[b]=e[h],e[h]=g,e=!1);b=0;for(d=a.length;b<d;b++)a[b].v=b,a[b].left||(e=a[b].v,a[b].v=a[b].b.v,a[b].b.v=e);e=Array(a.length);h=[];g=[];c=[];var k={};b=0;for(d=a.length;b<d;b++)if(!e[b]){var n=[];h.push(n);var l=h.length-1;g.push(0);c.push(-1);if(a[b].w){var p=a[b].w.m;a[b].w.B?k[p]&&(u(h[c[p]],l),c[l]=c[p],g[l]=g[p],k[l]=!0):(u(h[p],l),c[l]=p,g[l]=g[p]+1,k[l]=!0)}p=b;for(n.push(a[b].a);p>=b;){e[p]=!0;a[p].left?(a[p].B=!1,a[p].m=l):(a[p].b.B=!0,a[p].b.m=l);p=a[p].v;e[p]=!0;n.push(a[p].a);a:{for(var q=
a,t=e,v=p+1,w=q.length;v<w&&y(q[v].a,q[p].a);)if(t[v])v+=1;else{p=v;break a}for(v=p-1;t[v];)--v;p=v}}p=-1===p?b:p;e[p]=e[a[p].v]=!0;a[p].b.B=!0;a[p].b.m=l;g[l]&1&&n.reverse()}return h}var x=[],w=g("./edge_type"),t=g("tinyqueue"),l=g("bintrees").P,q=g("./sweep_event"),m=g("./compare_events"),v=g("./compare_segments"),D=g("./segment_intersection"),y=g("./equals"),C=Math.max,A=Math.min,B=0;c.exports=k;c.exports.union=function(a,b){return k(a,b,1)};c.exports.diff=function(a,b){return k(a,b,2)};c.exports.$=
function(a,b){return k(a,b,3)};c.exports.intersection=function(a,b){return k(a,b,0)};c.exports.operations={INTERSECTION:0,DIFFERENCE:2,UNION:1,XOR:3};c.exports.X=f;c.exports.V=a;c.exports.Z=r;c.exports.W=h;c.exports.Y=b},{"./compare_events":7,"./compare_segments":8,"./edge_type":9,"./equals":10,"./segment_intersection":12,"./sweep_event":14,bintrees:2,tinyqueue:6}],12:[function(g,c){function e(a,d){return a[0]*d[1]-a[1]*d[0]}function f(a,d){return a[0]*d[0]+a[1]*d[1]}c.exports=function(a,d,b,c,g){function u(a,
b,c){return[a[0]+b*c[0],a[1]+b*c[1]]}d=[d[0]-a[0],d[1]-a[1]];c=[c[0]-b[0],c[1]-b[1]];b=[b[0]-a[0],b[1]-a[1]];var k=e(d,c),x=f(d,d);if(k*k>1E-9*x*f(c,c)){c=e(b,c)/k;if(0>c||1<c)return null;b=e(b,d)/k;return 0>b||1<b?null:g?null:[u(a,c,d)]}var w=f(b,b),k=e(b,d);if(k*k>1E-9*x*w)return null;b=f(d,b)/x;k=b+f(d,c)/x;c=Math.min(b,k);b=Math.max(b,k);return 1>=c&&0<=b?1===c?g?null:[u(a,0<c?c:0,d)]:0===b?g?null:[u(a,1>b?b:1,d)]:g&&0===c&&1===b?null:[u(a,0<c?c:0,d),u(a,1>b?b:1,d)]:null}},{}],13:[function(g,
c){c.exports=function(c,f,a){return(c[0]-a[0])*(f[1]-a[1])-(f[0]-a[0])*(c[1]-a[1])}},{}],14:[function(g,c){function e(c,b,e,f,g){this.left=b;this.a=c;this.b=e;this.h=f;this.type=g||a.G;this.s=this.u=!1;this.w=null;this.B=this.C=!1}var f=g("./signed_area"),a=g("./edge_type");e.prototype={A:function(a){return this.left?0<f(this.a,this.b.a,a):0<f(this.b.a,this.a,a)},S:function(a){return!this.A(a)},N:function(){return this.a[0]===this.b.a[0]}};c.exports=e},{"./edge_type":9,"./signed_area":13}]},{},[1])(1)});
