(function(z){"object"===typeof exports&&"undefined"!==typeof module?module.exports=z():"function"===typeof define&&define.U?define([],z):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).martinez=z()})(function(){return function g(c,f,e){function a(b,r){if(!f[b]){if(!c[b]){var u="function"==typeof require&&require;if(!r&&u)return u(b,!0);if(d)return d(b,!0);u=Error("Cannot find module '"+b+"'");throw u.code="MODULE_NOT_FOUND",u;}u=f[b]={exports:{}};
c[b][0].call(u.exports,function(d){var r=c[b][1][d];return a(r?r:d)},u,u.exports,g,c,f,e)}return f[b].exports}for(var d="function"==typeof require&&require,b=0;b<e.length;b++)a(e[b]);return a}({1:[function(g,c){c.exports=g("./src/index")},{"./src/index":11}],2:[function(g,c){c.exports={P:g("./lib/rbtree"),T:g("./lib/bintree")}},{"./lib/bintree":3,"./lib/rbtree":4}],3:[function(g,c){function f(a){this.data=a;this.right=this.left=null}function e(a){this.c=null;this.m=a;this.size=0}var a=g("./treebase");
f.prototype.g=function(a){return a?this.right:this.left};f.prototype.l=function(a,b){a?this.right=b:this.left=b};e.prototype=new a;e.prototype.M=function(a){if(null===this.c)return this.c=new f(a),this.size++,!0;for(var b=0,h=null,r=this.c;;){if(null===r)return r=new f(a),h.l(b,r),ret=!0,this.size++,!0;if(0===this.m(r.data,a))return!1;b=0>this.m(r.data,a);h=r;r=r.g(b)}};e.prototype.remove=function(a){if(null===this.c)return!1;var b=new f(void 0),h=b;h.right=this.c;for(var r=null,e=null,k=1;null!==
h.g(k);){var r=h,h=h.g(k),c=this.m(a,h.data),k=0<c;0===c&&(e=h)}return null!==e?(e.data=h.data,r.l(r.right===h,h.g(null===h.left)),this.c=b.right,this.size--,!0):!1};c.exports=e},{"./treebase":5}],4:[function(g,c){function f(a){this.data=a;this.right=this.left=null;this.red=!0}function e(a){this.c=null;this.m=a;this.size=0}function a(a){return null!==a&&a.red}function d(a,d){var b=a.g(!d);a.l(!d,b.g(d));b.l(d,a);a.red=!0;b.red=!1;return b}function b(a,b){a.l(!b,d(a.g(!b),!b));return d(a,b)}var h=
g("./treebase");f.prototype.g=function(a){return a?this.right:this.left};f.prototype.l=function(a,b){a?this.right=b:this.left=b};e.prototype=new h;e.prototype.M=function(h){var e=!1;if(null===this.c)this.c=new f(h),e=!0,this.size++;else{var k=new f(void 0),c=0,g=0,t=null,l=k,q=null,m=this.c;for(l.right=this.c;;){null===m?(m=new f(h),q.l(c,m),e=!0,this.size++):a(m.left)&&a(m.right)&&(m.red=!0,m.left.red=!1,m.right.red=!1);if(a(m)&&a(q)){var v=l.right===t;m===q.g(g)?l.l(v,d(t,!g)):l.l(v,b(t,!g))}v=
this.m(m.data,h);if(0===v)break;g=c;c=0>v;null!==t&&(l=t);t=q;q=m;m=m.g(c)}this.c=k.right}this.c.red=!1;return e};e.prototype.remove=function(h){if(null===this.c)return!1;var e=new f(void 0),k=e;k.right=this.c;for(var c=null,g,t=null,l=1;null!==k.g(l);){var q=l;g=c;var c=k,k=k.g(l),m=this.m(h,k.data),l=0<m;0===m&&(t=k);if(!a(k)&&!a(k.g(l)))if(a(k.g(!l)))g=d(k,l),c.l(q,g),c=g;else if(!a(k.g(!l))&&(m=c.g(!q),null!==m))if(a(m.g(!q))||a(m.g(q))){var v=g.right===c;a(m.g(q))?g.l(v,b(c,q)):a(m.g(!q))&&g.l(v,
d(c,q));q=g.g(v);q.red=!0;k.red=!0;q.left.red=!1;q.right.red=!1}else c.red=!1,m.red=!0,k.red=!0}null!==t&&(t.data=k.data,c.l(c.right===k,k.g(null===k.left)),this.size--);this.c=e.right;null!==this.c&&(this.c.red=!1);return null!==t};c.exports=e},{"./treebase":5}],5:[function(g,c){function f(){}function e(a){this.L=a;this.j=[];this.f=null}f.prototype.clear=function(){this.c=null;this.size=0};f.prototype.find=function(a){for(var d=this.c;null!==d;){var b=this.m(a,d.data);if(0===b)return d.data;d=d.g(0<
b)}return null};f.prototype.o=function(a){for(var d=this.c,b=this.iterator();null!==d;){var h=this.m(a,d.data);if(0===h)return b.f=d,b;b.j.push(d);d=d.g(0<h)}return null};f.prototype.lowerBound=function(a){for(var d=this.c,b=this.iterator(),h=this.m;null!==d;){var e=h(a,d.data);if(0===e)return b.f=d,b;b.j.push(d);d=d.g(0<e)}for(e=b.j.length-1;0<=e;--e)if(d=b.j[e],0>h(a,d.data))return b.f=d,b.j.length=e,b;b.j.length=0;return b};f.prototype.upperBound=function(a){for(var d=this.lowerBound(a),b=this.m;null!==
d.data()&&0===b(d.data(),a);)d.next();return d};f.prototype.min=function(){var a=this.c;if(null===a)return null;for(;null!==a.left;)a=a.left;return a.data};f.prototype.max=function(){var a=this.c;if(null===a)return null;for(;null!==a.right;)a=a.right;return a.data};f.prototype.iterator=function(){return new e(this)};e.prototype.data=function(){return null!==this.f?this.f.data:null};e.prototype.next=function(){if(null===this.f){var a=this.L.c;null!==a&&this.K(a)}else if(null===this.f.right){do if(a=
this.f,this.j.length)this.f=this.j.pop();else{this.f=null;break}while(this.f.right===a)}else this.j.push(this.f),this.K(this.f.right);return null!==this.f?this.f.data:null};e.prototype.D=function(){if(null===this.f){var a=this.L.c;null!==a&&this.J(a)}else if(null===this.f.left){do if(a=this.f,this.j.length)this.f=this.j.pop();else{this.f=null;break}while(this.f.left===a)}else this.j.push(this.f),this.J(this.f.left)};e.prototype.K=function(a){for(;null!==a.left;)this.j.push(a),a=a.left;this.f=a};e.prototype.J=
function(a){for(;null!==a.right;)this.j.push(a),a=a.right;this.f=a};c.exports=f},{}],6:[function(g,c){function f(a,d){if(!(this instanceof f))return new f(a,d);this.data=a||[];this.length=this.data.length;this.compare=d||e;if(a)for(var b=Math.floor(this.length/2);0<=b;b--)this.I(b)}function e(a,d){return a<d?-1:a>d?1:0}c.exports=f;f.prototype={push:function(a){this.data.push(a);this.length++;this.R(this.length-1)},pop:function(){var a=this.data[0];this.data[0]=this.data[this.length-1];this.length--;
this.data.pop();this.I(0);return a},R:function(a){for(var d=this.data,b=this.compare;0<a;){var e=Math.floor((a-1)/2);if(0>b(d[a],d[e])){var c=d,f=c[e];c[e]=c[a];c[a]=f;a=e}else break}},I:function(a){for(var d=this.data,b=this.compare,e=this.length;;){var c=2*a+1,f=c+1,k=a;c<e&&0>b(d[c],d[k])&&(k=c);f<e&&0>b(d[f],d[k])&&(k=f);if(k===a)break;c=d;f=c[k];c[k]=c[a];c[a]=f;a=k}}}},{}],7:[function(g,c){var f=g("./signed_area");c.exports=function(e,a){var d=e.a,b=a.a;return d[0]>b[0]?1:d[0]<b[0]?-1:d[1]!==
b[1]?d[1]>b[1]?1:-1:e.left!==a.left?e.left?1:-1:0!==f(d,e.b.a,a.b.a)?e.A(a.b.a)?-1:1:e.h===a.h?e.i===a.i?0:e.i>a.i?1:-1:!e.h&&a.h?1:-1}},{"./signed_area":13}],8:[function(g,c){var f=g("./signed_area"),e=g("./compare_events"),a=g("./equals");c.exports=function(d,b){if(d===b)return 0;if(0!==f(d.a,d.b.a,b.a)||0!==f(d.a,d.b.a,b.b.a))return a(d.a,b.a)?d.A(b.b.a)?-1:1:d.a[0]===b.a[0]?d.a[1]<b.a[1]?-1:1:1===e(d,b)?b.S(d.a)?-1:1:d.A(b.a)?-1:1;if(d.h===b.h){if(a(d.a,b.a))return d.i===b.i?0:d.i>b.i?1:-1;if(d.h!==
b.h)return d.h&&!b.h?1:-1}return 1===e(d,b)?1:-1}},{"./compare_events":7,"./equals":10,"./signed_area":13}],9:[function(g,c){c.exports={G:0,O:1,H:2,F:3}},{}],10:[function(g,c){c.exports=function(c,e){return c[0]===e[0]&&c[1]===e[1]}},{}],11:[function(g,c){function f(a,b,d,c,e){var h,k;if("number"===typeof a[0][0])for(h=0,k=a.length-1;h<k;h++){var g=a[h],n=a[h+1],r=b,p=d+1,u=c,l=e,t=new q(g,!1,void 0,r),n=new q(n,!1,t,r);t.b=n;t.i=n.i=p;0<m(t,n)?n.left=!0:t.left=!0;l[0]=A(l[0],g[0]);l[1]=A(l[1],g[1]);
l[2]=C(l[2],g[0]);l[3]=C(l[3],g[1]);u.push(t);u.push(n)}else for(h=0,k=a.length;h<k;h++)B++,f(a[h],b,B,c,e)}function e(a,b,d,c){var e=new t(null,m);B=0;f(a,!0,0,e,d);f(b,!1,0,e,c);return e}function a(a,b,e,c){null===b?(a.u=!1,a.s=!0):a.h===b.h?(a.u=!b.u,a.s=b.s):(a.u=!b.s,a.s=b.N()?!b.u:b.u);b&&(a.w=!d(b,c)||b.N()?b.w:b);a.C=d(a,c)}function d(a,b){switch(a.type){case w.G:switch(b){case 0:return!a.s;case 1:return a.s;case 2:return a.h&&a.s||!a.h&&!a.s;case 3:return!0}case w.H:return 0===b||1===b;case w.F:return 2===
b}return!1}function b(a,b,d){var c=D(a.a,a.b.a,b.a,b.b.a),e=c?c.length:0;if(0===e||1===e&&(y(a.a,b.a)||y(a.b.a,b.b.a)))return 0;if(2===e&&a.h===b.h)return a.i===b.i&&console.warn("Edges of the same polygon overlap",a.a,a.b.a,b.a,b.b.a),0;if(1===e)return y(a.a,c[0])||y(a.b.a,c[0])||h(a,c[0],d),y(b.a,c[0])||y(b.b.a,c[0])||h(b,c[0],d),1;var c=[],f=e=!1;y(a.a,b.a)?e=!0:1===m(a,b)?c.push(b,a):c.push(a,b);y(a.b.a,b.b.a)?f=!0:1===m(a.b,b.b)?c.push(b.b,a.b):c.push(a.b,b.b);if(e&&f||e)return a.type=w.O,b.type=
a.u===b.u?w.H:w.F,e&&!f&&h(c[0].b,c[1].a,d),2;if(f)return h(c[0],c[1].a,d),3;if(c[0]!==c[3].b)return h(c[0],c[1].a,d),h(c[1],c[2].a,d),3;h(c[0],c[1].a,d);h(c[3].b,c[2].a,d);return 3}function h(a,b,d){var c=new q(b,!1,a,a.h);b=new q(b,!0,a.b,a.h);0<m(b,a.b)&&(a.b.left=!0,b.left=!1);a.b.b=b;a.b=c;d.push(b);d.push(c);return d}function r(d,c,e,h,f,k){var g;e=new l(v);c=[];for(var m=A(h[2],f[2]);d.length;){var n=d.pop();c.push(n);if(0===k&&n.a[0]>m||2===k&&n.a[0]>h[2])break;n.left?(e.M(n),g=e.o(n),f=e.o(n),
n.iterator=e.o(n),f.data()!==e.min()?f.D():(f=e.o(e.max()),f.next()),g.next(),a(n,f.data(),0,k),g.data()&&2===b(n,g.data(),d)&&(a(n,f.data(),0,k),a(n,g.data(),0,k)),f.data()&&2===b(f.data(),n,d)&&(g=e.o(f.data()),g.data()!==e.min()?g.D():(g=e.o(e.max()),g.next()),a(f.data(),g.data(),0,k),a(n,f.data(),0,k))):(n=n.b,g=e.o(n),(f=e.o(n))&&g&&(f.data()!==e.min()?f.D():(f=e.o(e.max()),f.next()),g.next(),e.remove(n),g.data()&&f.data()&&b(f.data(),g.data(),d)))}return c}function u(a,b){"[object Array]"===
Object.prototype.toString.call(a[0][0])||(a=[a]);a[b]=[]}function k(a,b,d){var c,f=null;if(0===a.length*b.length)if(0===d)f=x;else if(2===d)f=a;else if(1===d||3===d)f=0===a.length?b:a;if(c=f)return c===x?null:c;var f=[Infinity,Infinity,-Infinity,-Infinity],h=[Infinity,Infinity,-Infinity,-Infinity],g=e(a,b,f,h);c=null;if(f[0]>h[2]||h[0]>f[2]||f[1]>h[3]||h[1]>f[3])if(0===d)c=x;else if(2===d)c=a;else if(1===d||3===d)c=a.concat(b);if(c)return c===x?null:c;f=r(g,0,0,f,h,d);a=[];b=0;for(d=f.length;b<d;b++)h=
f[b],(h.left&&h.C||!h.left&&h.b.C)&&a.push(h);for(f=!1;!f;)for(f=!0,b=0,d=a.length;b<d;b++)b+1<d&&1===m(a[b],a[b+1])&&(f=a,h=b+1,g=f[b],f[b]=f[h],f[h]=g,f=!1);b=0;for(d=a.length;b<d;b++)a[b].v=b,a[b].left||(f=a[b].v,a[b].v=a[b].b.v,a[b].b.v=f);f=Array(a.length);h=[];g=[];c=[];var k={};b=0;for(d=a.length;b<d;b++)if(!f[b]){var n=[];h.push(n);var l=h.length-1;g.push(0);c.push(-1);if(a[b].w){var p=a[b].w.i;a[b].w.B?k[p]&&(u(h[c[p]],l),c[l]=c[p],g[l]=g[p],k[l]=!0):(u(h[p],l),c[l]=p,g[l]=g[p]+1,k[l]=!0)}p=
b;for(n.push(a[b].a);p>=b;){f[p]=!0;a[p].left?(a[p].B=!1,a[p].i=l):(a[p].b.B=!0,a[p].b.i=l);p=a[p].v;f[p]=!0;n.push(a[p].a);a:{for(var q=a,t=f,v=p+1,w=q.length;v<w&&y(q[v].a,q[p].a);)if(t[v])v+=1;else{p=v;break a}for(v=p-1;t[v];)--v;p=v}}p=-1===p?b:p;f[p]=f[a[p].v]=!0;a[p].b.B=!0;a[p].b.i=l;g[l]&1&&n.reverse()}return h}var x=[],w=g("./edge_type"),t=g("tinyqueue"),l=g("bintrees").P,q=g("./sweep_event"),m=g("./compare_events"),v=g("./compare_segments"),D=g("./segment_intersection"),y=g("./equals"),
C=Math.max,A=Math.min,B=0;c.exports=k;c.exports.union=function(a,b){return k(a,b,1)};c.exports.diff=function(a,b){return k(a,b,2)};c.exports.$=function(a,b){return k(a,b,3)};c.exports.intersection=function(a,b){return k(a,b,0)};c.exports.operations={INTERSECTION:0,DIFFERENCE:2,UNION:1,XOR:3};c.exports.X=e;c.exports.V=a;c.exports.Z=r;c.exports.W=h;c.exports.Y=b},{"./compare_events":7,"./compare_segments":8,"./edge_type":9,"./equals":10,"./segment_intersection":12,"./sweep_event":14,bintrees:2,tinyqueue:6}],
12:[function(g,c){function f(a,d){return a[0]*d[1]-a[1]*d[0]}function e(a,d){return a[0]*d[0]+a[1]*d[1]}c.exports=function(a,d,b,c,g){function u(a,b,c){return[a[0]+b*c[0],a[1]+b*c[1]]}d=[d[0]-a[0],d[1]-a[1]];c=[c[0]-b[0],c[1]-b[1]];b=[b[0]-a[0],b[1]-a[1]];var k=f(d,c),x=e(d,d);if(k*k>1E-9*x*e(c,c)){c=f(b,c)/k;if(0>c||1<c)return null;b=f(b,d)/k;return 0>b||1<b?null:g?null:[u(a,c,d)]}var w=e(b,b),k=f(b,d);if(k*k>1E-9*x*w)return null;b=e(d,b)/x;k=b+e(d,c)/x;c=Math.min(b,k);b=Math.max(b,k);return 1>=
c&&0<=b?1===c?g?null:[u(a,0<c?c:0,d)]:0===b?g?null:[u(a,1>b?b:1,d)]:g&&0===c&&1===b?null:[u(a,0<c?c:0,d),u(a,1>b?b:1,d)]:null}},{}],13:[function(g,c){c.exports=function(c,e,a){return(c[0]-a[0])*(e[1]-a[1])-(e[0]-a[0])*(c[1]-a[1])}},{}],14:[function(g,c){function f(c,b,e,f,g){this.left=b;this.a=c;this.b=e;this.h=f;this.type=g||a.G;this.s=this.u=!1;this.w=null;this.B=this.C=!1}var e=g("./signed_area"),a=g("./edge_type");f.prototype={A:function(a){return this.left?0<e(this.a,this.b.a,a):0<e(this.b.a,
this.a,a)},S:function(a){return!this.A(a)},N:function(){return this.a[0]===this.b.a[0]}};c.exports=f},{"./edge_type":9,"./signed_area":13}]},{},[1])(1)});
