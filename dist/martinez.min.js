(function(C){"object"===typeof exports&&"undefined"!==typeof module?module.exports=C():"function"===typeof define&&define.U?define([],C):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).martinez=C()})(function(){return function g(c,k,f){function a(b,l){if(!k[b]){if(!c[b]){var q="function"==typeof require&&require;if(!l&&q)return q(b,!0);if(d)return d(b,!0);q=Error("Cannot find module '"+b+"'");throw q.code="MODULE_NOT_FOUND",q;}q=k[b]={exports:{}};
c[b][0].call(q.exports,function(d){var l=c[b][1][d];return a(l?l:d)},q,q.exports,g,c,k,f)}return k[b].exports}for(var d="function"==typeof require&&require,b=0;b<f.length;b++)a(f[b]);return a}({1:[function(g,c){c.exports=g("./src/index")},{"./src/index":11}],2:[function(g,c){c.exports={P:g("./lib/rbtree"),T:g("./lib/bintree")}},{"./lib/bintree":3,"./lib/rbtree":4}],3:[function(g,c){function k(a){this.data=a;this.right=this.left=null}function f(a){this.c=null;this.l=a;this.size=0}var a=g("./treebase");
k.prototype.g=function(a){return a?this.right:this.left};k.prototype.j=function(a,b){a?this.right=b:this.left=b};f.prototype=new a;f.prototype.M=function(a){if(null===this.c)return this.c=new k(a),this.size++,!0;for(var b=0,h=null,l=this.c;;){if(null===l)return l=new k(a),h.j(b,l),ret=!0,this.size++,!0;if(0===this.l(l.data,a))return!1;b=0>this.l(l.data,a);h=l;l=l.g(b)}};f.prototype.remove=function(a){if(null===this.c)return!1;var b=new k(void 0),h=b;h.right=this.c;for(var l=null,q=null,e=1;null!==
h.g(e);){var l=h,h=h.g(e),f=this.l(a,h.data),e=0<f;0===f&&(q=h)}return null!==q?(q.data=h.data,l.j(l.right===h,h.g(null===h.left)),this.c=b.right,this.size--,!0):!1};c.exports=f},{"./treebase":5}],4:[function(g,c){function k(a){this.data=a;this.right=this.left=null;this.red=!0}function f(a){this.c=null;this.l=a;this.size=0}function a(a){return null!==a&&a.red}function d(a,d){var b=a.g(!d);a.j(!d,b.g(d));b.j(d,a);a.red=!0;b.red=!1;return b}function b(a,b){a.j(!b,d(a.g(!b),!b));return d(a,b)}var h=
g("./treebase");k.prototype.g=function(a){return a?this.right:this.left};k.prototype.j=function(a,b){a?this.right=b:this.left=b};f.prototype=new h;f.prototype.M=function(h){var f=!1;if(null===this.c)this.c=new k(h),f=!0,this.size++;else{var e=new k(void 0),c=0,g=0,t=null,p=e,r=null,n=this.c;for(p.right=this.c;;){null===n?(n=new k(h),r.j(c,n),f=!0,this.size++):a(n.left)&&a(n.right)&&(n.red=!0,n.left.red=!1,n.right.red=!1);if(a(n)&&a(r)){var u=p.right===t;n===r.g(g)?p.j(u,d(t,!g)):p.j(u,b(t,!g))}u=
this.l(n.data,h);if(0===u)break;g=c;c=0>u;null!==t&&(p=t);t=r;r=n;n=n.g(c)}this.c=e.right}this.c.red=!1;return f};f.prototype.remove=function(h){if(null===this.c)return!1;var f=new k(void 0),e=f;e.right=this.c;for(var c=null,g,t=null,p=1;null!==e.g(p);){var r=p;g=c;var c=e,e=e.g(p),n=this.l(h,e.data),p=0<n;0===n&&(t=e);if(!a(e)&&!a(e.g(p)))if(a(e.g(!p)))g=d(e,p),c.j(r,g),c=g;else if(!a(e.g(!p))&&(n=c.g(!r),null!==n))if(a(n.g(!r))||a(n.g(r))){var u=g.right===c;a(n.g(r))?g.j(u,b(c,r)):a(n.g(!r))&&g.j(u,
d(c,r));r=g.g(u);r.red=!0;e.red=!0;r.left.red=!1;r.right.red=!1}else c.red=!1,n.red=!0,e.red=!0}null!==t&&(t.data=e.data,c.j(c.right===e,e.g(null===e.left)),this.size--);this.c=f.right;null!==this.c&&(this.c.red=!1);return null!==t};c.exports=f},{"./treebase":5}],5:[function(g,c){function k(){}function f(a){this.L=a;this.h=[];this.f=null}k.prototype.clear=function(){this.c=null;this.size=0};k.prototype.find=function(a){for(var d=this.c;null!==d;){var b=this.l(a,d.data);if(0===b)return d.data;d=d.g(0<
b)}return null};k.prototype.m=function(a){for(var d=this.c,b=this.iterator();null!==d;){var h=this.l(a,d.data);if(0===h)return b.f=d,b;b.h.push(d);d=d.g(0<h)}return null};k.prototype.lowerBound=function(a){for(var d=this.c,b=this.iterator(),h=this.l;null!==d;){var f=h(a,d.data);if(0===f)return b.f=d,b;b.h.push(d);d=d.g(0<f)}for(f=b.h.length-1;0<=f;--f)if(d=b.h[f],0>h(a,d.data))return b.f=d,b.h.length=f,b;b.h.length=0;return b};k.prototype.upperBound=function(a){for(var d=this.lowerBound(a),b=this.l;null!==
d.data()&&0===b(d.data(),a);)d.next();return d};k.prototype.min=function(){var a=this.c;if(null===a)return null;for(;null!==a.left;)a=a.left;return a.data};k.prototype.max=function(){var a=this.c;if(null===a)return null;for(;null!==a.right;)a=a.right;return a.data};k.prototype.iterator=function(){return new f(this)};f.prototype.data=function(){return null!==this.f?this.f.data:null};f.prototype.next=function(){if(null===this.f){var a=this.L.c;null!==a&&this.K(a)}else if(null===this.f.right){do if(a=
this.f,this.h.length)this.f=this.h.pop();else{this.f=null;break}while(this.f.right===a)}else this.h.push(this.f),this.K(this.f.right);return null!==this.f?this.f.data:null};f.prototype.D=function(){if(null===this.f){var a=this.L.c;null!==a&&this.J(a)}else if(null===this.f.left){do if(a=this.f,this.h.length)this.f=this.h.pop();else{this.f=null;break}while(this.f.left===a)}else this.h.push(this.f),this.J(this.f.left)};f.prototype.K=function(a){for(;null!==a.left;)this.h.push(a),a=a.left;this.f=a};f.prototype.J=
function(a){for(;null!==a.right;)this.h.push(a),a=a.right;this.f=a};c.exports=k},{}],6:[function(g,c){function k(a,d){if(!(this instanceof k))return new k(a,d);this.data=a||[];this.length=this.data.length;this.compare=d||f;if(a)for(var b=Math.floor(this.length/2);0<=b;b--)this.I(b)}function f(a,d){return a<d?-1:a>d?1:0}c.exports=k;k.prototype={push:function(a){this.data.push(a);this.length++;this.R(this.length-1)},pop:function(){var a=this.data[0];this.data[0]=this.data[this.length-1];this.length--;
this.data.pop();this.I(0);return a},R:function(a){for(var d=this.data,b=this.compare;0<a;){var h=Math.floor((a-1)/2);if(0>b(d[a],d[h])){var f=d,c=f[h];f[h]=f[a];f[a]=c;a=h}else break}},I:function(a){for(var d=this.data,b=this.compare,f=this.length;;){var c=2*a+1,k=c+1,e=a;c<f&&0>b(d[c],d[e])&&(e=c);k<f&&0>b(d[k],d[e])&&(e=k);if(e===a)break;c=d;k=c[e];c[e]=c[a];c[a]=k;a=e}}}},{}],7:[function(g,c){var k=g("./signed_area");c.exports=function(f,a){var d=f.a,b=a.a;return d[0]>b[0]?1:d[0]<b[0]?-1:d[1]!==
b[1]?d[1]>b[1]?1:-1:f.left!==a.left?f.left?1:-1:0!==k(d,f.b.a,a.b.a)?f.w(a.b.a)?-1:1:!f.i&&a.i?1:-1}},{"./signed_area":13}],8:[function(g,c){var k=g("./signed_area"),f=g("./compare_events"),a=g("./equals");c.exports=function(d,b){return d===b?0:0!==k(d.a,d.b.a,b.a)||0!==k(d.a,d.b.a,b.b.a)?a(d.a,b.a)?d.w(b.b.a)?-1:1:d.a[0]===b.a[0]?d.a[1]<b.a[1]?-1:1:1===f(d,b)?b.S(d.a)?-1:1:d.w(b.a)?-1:1:d.i!==b.i?d.i&&!b.i?1:-1:a(d.a,b.a)?0:1===f(d,b)?1:-1}},{"./compare_events":7,"./equals":10,"./signed_area":13}],
9:[function(g,c){c.exports={G:0,O:1,H:2,F:3}},{}],10:[function(g,c){c.exports=function(c,f){return c[0]===f[0]&&c[1]===f[1]}},{}],11:[function(g,c){function k(a,b,d,f){var y,c;if("number"===typeof a[0][0])for(y=0,c=a.length-1;y<c;y++){var h=a[y],e=a[y+1],g=b,l=d,m=f;if(!w(h,e)){var q=new r(h,!1,void 0,g),e=new r(e,!1,q,g);q.b=e;0<n(q,e)?e.left=!0:q.left=!0;m[0]=A(m[0],h[0]);m[1]=A(m[1],h[1]);m[2]=B(m[2],h[0]);m[3]=B(m[3],h[1]);l.push(q);l.push(e)}}else for(y=0,c=a.length;y<c;y++)k(a[y],b,d,f)}function f(a,
b,d,c){var f=new t(null,n);k(a,!0,f,d);k(b,!1,f,c);return f}function a(a,b,f,c){null===b?(a.s=!1,a.o=!0):a.i===b.i?(a.s=!b.s,a.o=b.o):(a.s=!b.o,a.o=b.N()?!b.s:b.s);b&&(a.v=!d(b,c)||b.N()?b.v:b);a.C=d(a,c)}function d(a,b){switch(a.type){case v.G:switch(b){case 0:return!a.o;case 1:return a.o;case 2:return a.i&&a.o||!a.i&&!a.o;case 3:return!0}case v.H:return 0===b||1===b;case v.F:return 2===b}return!1}function b(a,b,d){var c=D(a.a,a.b.a,b.a,b.b.a),f=c?c.length:0;if(0===f||1===f&&(w(a.a,b.a)||w(a.b.a,
b.b.a)))return 0;if(2===f&&a.i===b.i)throw console.warn(a.a,a.b.a,b.a,b.b.a),Error("Edges of the same polygon overlap");if(1===f)return w(a.a,c[0])||w(a.b.a,c[0])||h(a,c[0],d),w(b.a,c[0])||w(b.b.a,c[0])||h(b,c[0],d),1;var c=[],e=f=!1;w(a.a,b.a)?f=!0:1===n(a,b)?c.push(b,a):c.push(a,b);w(a.b.a,b.b.a)?e=!0:1===n(a.b,b.b)?c.push(b.b,a.b):c.push(a.b,b.b);if(f&&e||f)return a.type=v.O,b.type=a.s===b.s?v.H:v.F,f&&!e&&h(c[2].b,c[1].a,d),2;if(e)return h(c[0],c[1].a,d),3;if(c[0]!==c[3].b)return h(c[0],c[1].a,
d),h(c[1],c[2].a,d),3;h(c[0],c[1].a,d);h(c[3].b,c[2].a,d);return 3}function h(a,b,d){var c=new r(b,!1,a,a.i);b=new r(b,!0,a.b,a.i);0<n(b,a.b)&&(a.b.left=!0,b.left=!1);a.b.b=b;a.b=c;d.push(b);d.push(c);return d}function l(d,c,f,h,e,k){var g;f=new p(u);c=[];for(var n=A(h[2],e[2]);d.length;){var l=d.pop();c.push(l);if(0===k&&l.a[0]>n||2===k&&l.a[0]>h[2])break;l.left?(f.M(l),g=f.m(l),e=f.m(l),l.iterator=f.m(l),e.data()!==f.min()?e.D():(e=f.m(f.max()),e.next()),g.next(),a(l,e.data(),0,k),g.data()&&2===
b(l,g.data(),d)&&(a(l,e.data(),0,k),a(l,g.data(),0,k)),e.data()&&2===b(e.data(),l,d)&&(g=f.m(e.data()),g.data()!==f.min()?g.D():(g=f.m(f.max()),g.next()),a(e.data(),g.data(),0,k),a(l,e.data(),0,k))):(l=l.b,g=f.m(l),(e=f.m(l))&&g&&(e.data()!==f.min()?e.D():(e=f.m(f.max()),e.next()),g.next(),f.remove(l),g.data()&&e.data()&&b(e.data(),g.data(),d)))}return c}function q(a,b){"[object Array]"===Object.prototype.toString.call(a[0][0])||(a=[a]);a[b]=[]}function e(a,b,d){var c,e=null;if(0===a.length*b.length)if(0===
d)e=x;else if(2===d)e=a;else if(1===d||3===d)e=0===a.length?b:a;if(c=e)return c===x?null:c;var e=[Infinity,Infinity,-Infinity,-Infinity],h=[Infinity,Infinity,-Infinity,-Infinity],g=f(a,b,e,h);c=null;if(e[0]>h[2]||h[0]>e[2]||e[1]>h[3]||h[1]>e[3])if(0===d)c=x;else if(2===d)c=a;else if(1===d||3===d)c=a.concat(b);if(c)return c===x?null:c;e=l(g,0,0,e,h,d);a=[];b=0;for(d=e.length;b<d;b++)if(h=e[b],h.left&&h.C||!h.left&&h.b.b.C)a.push(h),a.push(h.b);for(e=!1;!e;)for(e=!0,b=0,d=a.length;b<d;b++)b+1<d&&1===
n(a[b],a[b+1])&&(e=a,h=b+1,g=e[b],e[b]=e[h],e[h]=g,e=!1);b=0;for(d=a.length;b<d;b++)a[b].u=b,a[b].left||(e=a[b].u,a[b].u=a[b].b.u,a[b].b.u=e);e=Array(a.length);h=[];g=[];c=[];var k={};b=0;for(d=a.length;b<d;b++)if(!e[b]){var r=[];h.push(r);var p=h.length-1;g.push(0);c.push(-1);if(a[b].v){var m=a[b].v.B;a[b].v.A?k[m]&&(q(h[c[m]],p),c[p]=c[m],g[p]=g[m],k[p]=!0):(q(h[m],p),c[p]=m,g[p]=g[m]+1,k[p]=!0)}var m=b,t=a[b].a;r.push(t);try{for(;!w(a[m].b.a,t);){e[m]=!0;a[m].left?(a[m].A=!1,a[m].B=p):(a[m].b.A=
!0,a[m].b.B=p);m=a[m].u;e[m]=!0;r.push(a[m].a);a:{for(var u=m,v=a,A=e,z=u+1;z<v.length&&w(v[z].a,v[u].a);)if(A[z])z+=1;else{m=z;break a}for(z=u-1;A[z];)--z;m=z}}e[m]=e[a[m].u]=!0;a[m].b.A=!0;a[m].b.B=p}catch(B){console.log(m||0,a,a.length,B)}g[p]&1&&r.reverse()}return h}var x=[],v=g("./edge_type"),t=g("tinyqueue"),p=g("bintrees").P,r=g("./sweep_event"),n=g("./compare_events"),u=g("./compare_segments"),D=g("./segment_intersection"),w=g("./equals"),B=Math.max,A=Math.min;c.exports=e;c.exports.union=
function(a,b){return e(a,b,1)};c.exports.diff=function(a,b){return e(a,b,2)};c.exports.$=function(a,b){return e(a,b,3)};c.exports.intersection=function(a,b){return e(a,b,0)};c.exports.operations={INTERSECTION:0,DIFFERENCE:2,UNION:1,XOR:3};c.exports.X=f;c.exports.V=a;c.exports.Z=l;c.exports.W=h;c.exports.Y=b},{"./compare_events":7,"./compare_segments":8,"./edge_type":9,"./equals":10,"./segment_intersection":12,"./sweep_event":14,bintrees:2,tinyqueue:6}],12:[function(g,c){function k(a,d){return a[0]*
d[1]-a[1]*d[0]}function f(a,d){return a[0]*d[0]+a[1]*d[1]}c.exports=function(a,d,b,c,g){function q(a,b,d){return[a[0]+b*d[0],a[1]+b*d[1]]}d=[d[0]-a[0],d[1]-a[1]];c=[c[0]-b[0],c[1]-b[1]];b=[b[0]-a[0],b[1]-a[1]];var e=k(d,c),x=f(d,d);if(e*e>1E-9*x*f(c,c)){c=k(b,c)/e;if(0>c||1<c)return null;b=k(b,d)/e;return 0>b||1<b?null:g?null:[q(a,c,d)]}var v=f(b,b),e=k(b,d);if(e*e>1E-9*x*v)return null;b=f(d,b)/x;e=b+f(d,c)/x;c=Math.min(b,e);b=Math.max(b,e);return 1>=c&&0<=b?1===c?g?null:[q(a,0<c?c:0,d)]:0===b?g?
null:[q(a,1>b?b:1,d)]:g&&0===c&&1===b?null:[q(a,0<c?c:0,d),q(a,1>b?b:1,d)]:null}},{}],13:[function(g,c){c.exports=function(c,f,a){return(c[0]-a[0])*(f[1]-a[1])-(f[0]-a[0])*(c[1]-a[1])}},{}],14:[function(g,c){function k(d,b,c,f,g){this.left=b;this.a=d;this.b=c;this.i=f;this.type=g||a.G;this.o=this.s=!1;this.v=null;this.A=this.C=!1}var f=g("./signed_area"),a=g("./edge_type");k.prototype={w:function(a){return this.left?0<f(this.a,this.b.a,a):0<f(this.b.a,this.a,a)},S:function(a){return!this.w(a)},N:function(){return this.a[0]===
this.b.a[0]}};c.exports=k},{"./edge_type":9,"./signed_area":13}]},{},[1])(1)});
